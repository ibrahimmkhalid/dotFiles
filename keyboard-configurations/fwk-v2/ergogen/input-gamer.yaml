points:
  zones:
    main:
      columns:
        outer:
          key:
            column_net: P3
        pinky:
          key:
            column_net: P4
        ring:
          key:
            column_net: P5
            stagger: 7
        middle:
          key:
            column_net: P6
            stagger: 7
        index:
          key:
            column_net: P7
            stagger: -7
        inner:
          key:
            column_net: P8
        extra:
          key:
            column_net: P9
            stagger: -5
          rows:
            num.skip: true
      rows:
        bottom:
          row_net: P20
        home:
          row_net: P19
        top:
          row_net: P18
        num:
          row_net: P15
    thumbfan:
      anchor:
        ref: main_index_bottom
        shift: [-U/2, -1.05U]
      columns:
        pos1:
          key:
            column_net: P6
        pos2:
          key:
            column_net: P7
            rotate: -10
            shift: [1.55,-1.7]
        pos3:
          key:
            column_net: P8
            rotate: -20
            shift: [2.45, -7]
        pos4:
          key:
            column_net: P9
            rotate: -20
            shift: [-U-3.95, -5.75-U]
        pos5:
          key:
            column_net: P10
            rotate: -20
            shift: [-U-3.05,-U-7]
      rows:
        bottom:
          row_net: P21
outlines:
  nraw:
    - what: rectangle
      where: true
      size: [1.5U,1.5U]
    - what: rectangle
      where: true
      size: [U,U]
      operation: stack
    - what: rectangle
      where: true
      size: [14,14]
      operation: stack
  raw:
    - what: rectangle #keys
      where: true
      size: [U+1,U+1]
    - what: polygon # board
      where:
        ref: main_outer_bottom
      points:
        - shift: [-12.5,-12]
        - shift: [0,100]
        - shift: [112.5, 0]
        - shift: [3, -9]
        - shift: [20,0]
        - shift: [15, -125]
        - shift: [-15,-10]
        - shift: [-60, 19.9]
        - shift: [0,1.1]
    - what: circle
      where:
        ref: main_outer_bottom
        shift: [-10,-162]
      radius: 150
      operation: subtract
    - what: polygon
      where:
        ref: main_outer_bottom
        shift: [-9.5,-9]
      points:
        - shift: [-3,1]
        - shift: [5,-5]
        - shift: [-10,-6]
      operation: subtract
    - what: circle
      where:
        ref: main_outer_bottom
        shift: [-8.4,-8.0]
      radius: 4
  fwk_pcb:
    - what: outline
      name: raw
      fillet: 4
  fwk_pcb_with_components:
    - what: outline
      name: fwk_pcb
    - what: rectangle
      where: true
      size: 18
      operation: stack
    - what: rectangle
      where: 
        ref: main_inner_num
        shift: [7.3-5.4,U-1.8]
        rotate: -90+19
      size: [6, 14]
      operation: stack
    - what: rectangle
      where:
        ref: main_outer_num
        shift: [0.5U-2.5,20]
      size: [33, 17.6]
      operation: stack
  fwk_plate:
    - what: outline
      name: fwk_pcb
    - what: rectangle
      where: true
      size: [14,14]
      operation: subtract
pcbs:
  fwk_pcb:
    outlines:
      fwk_pcb:
        outline: fwk_pcb
    footprints:
      keys:
        what: mx
        where: true
        params:
          keycaps: true
          hotswap: true
          reverse: true
          from: "{{colrow}}"
          to: "{{column_net}}"
      diodes:
        what: diode
        where: true
        adjust:
          rotate: 180
          shift: [0, -5]
        params:
          from: "{{row_net}}"
          to: "{{colrow}}"
      vias:
        what: via
        where: true
        adjust:
          shift: [0.5U, 7]
        params:
          net: "{{column_net}}"
      promicro:
        what: promicro
        where:
          ref: main_outer_num
          shift: [0.5U-2.5,20]
      trrs:
        what: trrs
        where: 
          ref: main_inner_num
          shift: [7.3,U-1.8]
          rotate: -90+19
        params:
          reverse: true
          symmetric: true
          A: GND
          B: GND
          C: P2
          D: VCC
